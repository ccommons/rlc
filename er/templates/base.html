<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
{% load staticfiles %}
{% block header_media %}
<link rel="stylesheet" type="text/css" href="{% static "vendor/bootstrap.css" %}" />
<link type="text/css" href="{% static "vendor/jscrollpane/jquery.jscrollpane.css" %}" rel="stylesheet" media="all" />
<link rel="stylesheet" type="text/css" href="{% static "base.css" %}" />
<link rel="stylesheet" type="text/css" href="{% static "er.css" %}" />
<script src="{% static "vendor/jquery-1.8.3.min.js" %}"></script>
<script src="{% static "vendor/bootstrap.js" %}"></script>
<script src="{% static "vendor/jscrollpane/jquery.mousewheel.js" %}"></script>
<script src="{% static "vendor/jscrollpane/jquery.jscrollpane.min.js" %}"></script>
<script src="{% static "doc.js" %}"></script>
<script src="{% static "modal.js" %}"></script>
<script src="{% static "popover.js" %}"></script>
<script src="{% static "annotation.js" %}"></script>
<script src="{% static "notification.js" %}"></script>
{% if override_ckeditor == True %}
<script src="{% static "vendor/ckeditor/ckeditor.js" %}"></script>
{% else %}
{{widget_media|safe}}
{% endif %}
{% endblock %}
{% block head_extras %}{% endblock %}
<title>{{ doctitle }}</title>
</head>
<body>
<div id="main-wrapper">
{% block header %}
{% include "header.html" %}
{% endblock %}
{% block maincontent %}
   main content
{% endblock %}
</div>
{% block footer %}
{% include "footer.html" %}
{% endblock %}
<script type="text/javascript">
	var pane = $('#toc-container'),
		api;
	
	$(window).on('resize', function () {
		//Calculate and resize ToC height.
		var totalHeight = window.innerHeight,
            TOP_MARGIN = 143, //The distance from the ToC's header to the top of the window.
            availableHeight = (totalHeight - TOP_MARGIN) - 30,
            contentHeight = 0;

        pane.find('ul').each(function (index, el) {
            contentHeight = contentHeight + $(el).outerHeight();
        }.bind(this));
        if (availableHeight <= contentHeight) {
            pane.css({'height': availableHeight});
            if (!api) {
            	pane.jScrollPane();
				api = pane.data('jsp');
            } else {
            	//Reinitialize the scroll on the ToC.
				api.reinitialise();
            }
        } else {
            if (api) {
            	api.destroy();
            	api = null;
            }
            //We need to reset the DOM object as it gets replaced
            //after the plugin gets (re)initialised.
            pane = $('#toc-container');
            pane.css({'height': 'auto'});
        }
        //End height resize.
	});
	$(window).trigger('resize');
</script>
</body>
</html>
